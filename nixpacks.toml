[phases.setup]
nixPkgs = ["nodejs-18_x"]

[phases.install]
cmds = [
  "pwd",
  "ls -la",
  "test -f package.json || (echo 'ERROR: package.json not found!' && exit 1)",
  "npm run install-all"
]

[phases.build]
cmds = [
  "npm run build"
]

[start]
cmd = "sh -c 'pwd && ls -la && if [ ! -f package.json ]; then if [ -f /app/package.json ]; then cd /app; elif [ -f ../package.json ]; then cd ..; else PKG=$(find /app -name package.json 2>/dev/null | head -1); [ -n \"$PKG\" ] && cd \"$(dirname \"$PKG\")\"; fi; fi && pwd && npm start'"

